# 需求文档

## 项目介绍

### 项目说明

项目名称：接口防刷小工具

任务提出者：祝宇平

开发者：张理泰

### 项目背景

用户利用手机号注册账号，需要接收短信验证码、用户提交订单、用户通过账号密码登陆，这些场景对于用户或者资源的访问都应该加入接口防刷机制。

## 需求说明

### 整体需求

基于Java注解+AOP+SpEL+Redis，实现一个接口防刷的小工具，并输出一个jar包，供外部使用。防刷的场景有可能是公共资源的总次数、资源每天固定的访问次数、单个用户对资源每天固定的访问次数、资源一段时间内固定的访问次数、单个用户对资源一段时间内固定的访问次数等，需要抽象和提供一定通用扩展支持。

### 整体模块划分

主要分为两部分：公共资源防刷和私有资源防刷

### 功能性需求(需求详情)

#### 工具通过注解的方式使用

* 工具的使用是通过Java注解的形式。

* 在需要限流的接口前加上指定的注解，输入与限流有关的参数，即可实现限流的功能。

#### 根据不同场景实现限流功能

##### 公共资源

* 公共资源有访问总次数限制，超出限定次数之后该资源接口将不能再被访问。
* 公共资源固定时间内有访问资源的次数限制。在一段时间内，公共资源有访问次数的限制，超出限定次数之后此段时间内无法再访问此公共资源，需等待一段时间后重新访问。

##### 私有资源

* 私有资源固定时间内对单个用户的访问次数限制。在一段时间内，单个用户对资源有访问次数的限制，该用户在此段时间内访问次数超限后将无法再访问此资源，需等待一段时间后重新访问。对单个用户的限制通过用户ID或用户名等实现。

#### 异常处理和简单的视图提示

*  当对接口的访问次数超限后，需抛出异常，并有相应异常处理器捕获异常，并返回简单的视图显示提示信息，例如还需多少时间才可再次访问。

#### 输出jar包供外部使用

* 编码完成后，需要将项目输出一个jar包，以供外部使用。

### 非功能性需求

#### 需要有一定扩展支持

* 在使用注解时，可传入不同的时间和访问次数来面对不同的场景，并且根据注解中是否传入RedisKey来判断是否为公共资源。
* 可以对异常处理器和视图信息进行扩展。

